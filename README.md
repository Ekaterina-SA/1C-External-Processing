# Внешняя обработка 1С — Работа с ведомостями

## Описание
Внешняя обработка разработана в рамках технического задания.  
Реализована для работы с документами «Ведомости» и их табличными частями (договорами).  
Содержит две основные команды:
- «Заполнить нужное»
- «Удалить лишнее»

---

## Команда «Заполнить нужное»

Обработка:
- Программно формирует таблицу ведомостей (ссылки на документы).
- Отбирает ведомости по условию:
  - Дата начала действия первого активного договора равна/не равна минимальной/максимальной дате в табличной части.
- Выполняет динамическое исключение ведомостей в зависимости от текущей даты:
  - 11–20 день — исключаются документы с чётным числом дня.
- Сортирует ведомости по возрастанию даты документа.
- Показывает на форме только колонку со ссылками на документы.
- Выделяет светло-зелёным строки с последним статусом «Акцептован» (по данным регистра «ИсторияСтатусовДокументов»).

Условное оформление:
- Женский пол кандидата — через конструктор формы.

---

## Команда «Удалить лишнее»

Обработка:
- Удаляет строки, где количество договоров в табличной части чётное.
- Выводит пользователю сообщение по формату:

---

- Сортировка номеров — по возрастанию.

---

## Информирование пользователя

В зависимости от длины фамилии:

| Длина фамилии | Способ сообщения |
|---------------|------------------|
| 10–11 | Элемент формы обработки |

---

## Платформа
Платформа: 1С:Предприятие 8.3  
Формат файла: внешняя обработка .epf

---

## Особенности реализации
- Использованы серверные и клиентские процедуры.
- Оптимизированы обращения к регистра сведений и таблицам.
- Код снабжён комментариями для удобства чтения и поддержки.
